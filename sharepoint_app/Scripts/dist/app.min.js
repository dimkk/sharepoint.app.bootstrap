"use strict";angular.module("spapp",["ui.bootstrap","ui.router","ngAnimate"]).config(function(n,t){n.state("wizard",{url:"/wizard",templateUrl:"../Scripts/src/views/wizard.html",controller:"wizardController"}).state("wizard.step1",{url:"/step1",templateUrl:"../Scripts/src/views/wizardStep1.html"}).state("wizard.step2",{url:"/step2",templateUrl:"../Scripts/src/views/wizardStep2.html"}).state("wizard.step3",{url:"/step3",templateUrl:"../Scripts/src/views/wizardStep3.html"});t.otherwise("/wizard/step1")});angular.module("spapp").controller("wizardController",["$q","$scope","$state","$location",function(n,t,i){function r(i,r){function c(n){u.resolve(n)}function l(n){u.reject(n)}var u=n.defer(),f=new SP.ClientContext(_spPageContextInfo.webAbsoluteUrl),s=f.get_web().get_lists().getByTitle(r),h=new SP.ListItemCreationInformation,e=s.addItem(h);for(var o in t.data)e.set_item(o,i[o]);return e.update(),f.load(e),f.executeQueryAsync(c,l),u.promise}t.data=t.data||{};t.getBtnStyle=function(n){return i.$current.name.indexOf(n)!=-1?"btn-primary":"btn-default"};t.getDisabled=function(n){if(n=="step1")return!1;switch(i.$current.name){case"wizard.step1":return n=="step3"?!0:t.wizardForm.firstName.$invalid||t.wizardForm.lastName.$invalid;case"wizard.step2":return t.wizardForm.companyName.$invalid||t.wizardForm.companyAddress.$invalid;case"wizard.step3":var r=t.wizardForm.companyName.$invalid||t.wizardForm.companyAddress.$invalid||t.wizardForm.firstName.$invalid||t.wizardForm.lastName.$invalid;return console.log(r),r}};t.saveToSharePoint=function(){SP.SOD.executeFunc("sp.js","SP.ClientContext",function(){r(t.data,"testList").then(function(){$window.location.href=_spPageContextInfo.webAbsoluteUrl+"/Pages/listView.aspx"})})}}]);
//# sourceMappingURL=app.min.js.map
